<!DOCTYPE html>
<html lang="en">
	<head>
		<script>
			let update = () => {};
			let value = 0;

			function connectOpenActionSocket(inPort, inPropertyInspectorUUID, inRegisterEvent, inInfo, inActionInfo) {
				const websocket = new WebSocket("ws://localhost:" + inPort);
				inActionInfo = JSON.parse(inActionInfo);
				websocket.onopen = () => {
					websocket.send(JSON.stringify({
						event: inRegisterEvent,
						uuid: inPropertyInspectorUUID,
					}));
				};
				value = inActionInfo.payload.settings.value ?? 0;
				websocket.onmessage = (event) => {
					const data = JSON.parse(event.data);
					if (data.event == "didReceiveSettings") {
						value = data.payload.settings.value ?? 0;
					}
				};

				const step = document.getElementById("step");
				step.value = inActionInfo.payload.settings.step ?? 1;

				update = () => {
					websocket.send(JSON.stringify({
						event: "setSettings",
						context: inActionInfo.context,
						payload: {
							step: parseInt(step.value) || 1,
							value: value,
						},
					}));
				};
			}

			const connectElgatoStreamDeckSocket = connectOpenActionSocket;
		</script>

		<style>
			* {
				font-family: system-ui, sans-serif;
				font-size: 16px;
				color: oklch(92.2% 0 0);
			}
			body {
				margin: 16px;
				background-color: oklch(20.5% 0 0);
			}
			label {
				margin-right: 4px;
			}
			input {
				padding: 4px;
				background-color: oklch(26.8% 0.007 34.298);
				border: 1px solid oklch(55.6% 0 0);
				border-radius: 4px;
			}
		</style>
	</head>

	<body>
		<div>
			<label for="step">Step:</label>
			<input id="step" oninput="update();" type="number" />
		</div>
	</body>
</html>
